{% extends "layout/base.html" %}

{% block content %}
    <div class="container mt-5">
        <h2>Lịch sử giao dịch</h2>

        {% if giao_dichs %}
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>Ngày bay</th>
                        <th>Chuyến bay</th>
                        <th>Hạng vé</th>
                        <th>Giá vé</th>
                        <th>Thời gian giao dịch</th>
                        <th>Tên ghế</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>
                <tbody>
                    {% for giao_dich in giao_dichs %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ giao_dich.chuyenBay.gioDi.strftime('%H:%M %d/%m/%Y') if giao_dich.chuyenBay.gioDi else 'N/A' }}</td>
                        <td>{{ giao_dich.chuyenBay.tuyenBay.tenTuyenBay if giao_dich.chuyenBay else 'Không có chuyến bay' }}</td>
                        <td>
                            {% if giao_dich.loaiVe == 'ThuongGia' %}
                                Thương Gia
                            {% elif giao_dich.loaiVe == 'PhoThong' %}
                                Phổ thông
                            {% endif %}
                        </td>
                        <td>{{ "{:,.0f}".format(giao_dich.giaVe) }} VND</td>
                        <td>{{ giao_dich.thoiGianGiaoDich.strftime('%H:%M %d/%m/%Y') if giao_dich.thoiGianGiaoDich else 'N/A' }}</td>
                        <td>{{ giao_dich.tenGhe if giao_dich.tenGhe else 'Không xác định' }}</td>
                        <td class="
                            {% if giao_dich.tinhTrangVe == 'Đã đặt' %}
                                text-success
                            {% elif giao_dich.tinhTrangVe == 'Đã hủy' %}
                                text-danger
                            {% elif giao_dich.tinhTrangVe == 'Đã sử dụng' %}
                                text-warning
                            {% else %}
                                text-secondary
                            {% endif %}
                        ">
                            {{ giao_dich.tinhTrangVe }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="alert alert-info">
                Bạn chưa có giao dịch nào.
            </div>
        {% endif %}
    </div>
{% endblock %}
